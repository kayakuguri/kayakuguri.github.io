<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: php | KayaMemo]]></title>
  <link href="http://kayakuguri.github.io/blog/categories/php/atom.xml" rel="self"/>
  <link href="http://kayakuguri.github.io/"/>
  <updated>2015-06-11T11:00:35+09:00</updated>
  <id>http://kayakuguri.github.io/</id>
  <author>
    <name><![CDATA[è±æ½œ]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Session Fixation]]></title>
    <link href="http://kayakuguri.github.io/blog/2015/05/21/session-fixation/"/>
    <updated>2015-05-21T19:09:52+09:00</updated>
    <id>http://kayakuguri.github.io/blog/2015/05/21/session-fixation</id>
    <content type="html"><![CDATA[<p>ä»Šæ›´ãªãŒã‚‰ã€Session Fixationãªã‚‹ã‚‚ã®ã‚’çŸ¥ã£ãŸã®ã§ãƒ¡ãƒ¢ã€‚</p>

<!-- more -->


<p>å†…å®¹ã¯ä»¥ä¸‹ã€å¾³ä¸¸å…ˆç”ŸãŒè©³ã—ã„ã€‚<br/>
<a href="http://blog.tokumaru.org/2009/01/introduction-to-session-fixation-attack.html">ã¨ãã¾ã‚‹ã²ã‚ã—ã®Session Fixationæ”»æ’ƒå…¥é–€ | å¾³ä¸¸æµ©ã®æ—¥è¨˜</a></p>

<p>æ—¥æœ¬èªã§ã¯ã€<code>ã‚»ãƒƒã‚·ãƒ§ãƒ³å›ºå®šæ”»æ’ƒ</code>ã¨å‘¼ã°ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã€<br/>
ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§è¡Œã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆã«å¯¾ã—ã¦ã€ä½•ã‚‰ã‹ã®æ–¹æ³•ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ„å›³ã—ãŸå›ºå®šã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä¸ãˆãŸçŠ¶æ…‹ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚‚ã‚‰ã„ã€<br/>
æ”»æ’ƒè€…ã¯ãã®IDã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸã“ã¨ã«ã™ã‚‹ã€ã¨ã„ã†ã‚‚ã®ã®ã‚ˆã†ã€‚</p>

<p>å¯¾ç­–ã¨ã—ã¦ã¯ä»¥ä¸‹ã„ãšã‚Œã‹ã«ãªã‚‹ã‚ˆã†ã€‚</p>

<blockquote><p>(1) ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°å†…ã«ç‰¹å®šã®å€¤ã‚’å¸¸ã«ä¸ãˆã‚‹ã‚ˆã†ã«ã—ã€ã‚‚ã—ãã®å€¤ãŒç„¡ã‹ã£ãŸå ´åˆã«ã¯æ­£ã—ããµã‚‰ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³IDã§ã¯ãªã„ã¨åˆ¤æ–­ã™ã‚‹ã€‚<br/>
(ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã®æ­£å½“æ€§ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°å†…ã«åŸ‹ã‚è¾¼ã‚€)<br/>
(2) ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ãªã©ã€ãã®ã‚µã‚¤ãƒˆã§ã®æœ¬æ¥ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä½¿ç”¨ã‚’è¡Œã†æ™‚ç‚¹ã§(é‡è¦ãªæƒ…å ±ã‚’æŒãŸã›ã‚‹ã¨ãã«)ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’å¤‰æ›´ã™ã‚‹ã€‚
<a href="http://pentan.info/php/session_fixation.html">http://pentan.info/php/session_fixation.html</a></p></blockquote>

<p>2ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä»˜ã‘æ›¿ãˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã€‚</p>

<pre><code>session_start();
session_destroy();
session_start();
session_regenerate_id();
</code></pre>

<p>ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã—ã€ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«æ ¼ç´ã™ã‚‹ç›´å‰ã«ä»˜ã‘æ›¿ãˆã‚’å…¥ã‚Œã¦ã‚„ã‚Œã°ã€<br/>
ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«ã¯åˆ¥ã®IDã¨ãªã‚‹ã®ã§ã€æ”»æ’ƒå´ãŒç”¨æ„ã—ãŸå›ºå®šIDã‚’å›é¿ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã€‚</p>

<p>ãŸã ã—ã“ã®ã€<code>session_regenerate_id</code>ã¯çµæ§‹ãªè² è·ãŒã‹ã‹ã‚‹ã‚ˆã†ã§ã€<br/>
é€£ç¶šã—ã¦ä½¿ç”¨ã—ã¦ã„ã‚‹ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒåˆ‡ã‚Œã¦ã—ã¾ã†ã‚‰ã—ã„ã€‚<br/>
ãªã®ã§ã€é€£ç¶šçš„ã«å®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹äº‹ãŒé‡è¦ã£ã½ã„ã€‚<br/>
ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ä¸€å›ã®ã¿å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ãŠã‘ã°ç‰¹ã«å•é¡Œãªã•ãã†ã€‚</p>

<h2>å‚è€ƒ</h2>

<p><a href="http://canalize.jp/archives/009281.php">ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ ã¨ session_regenerate_id( )é–¢æ•° &ndash; Shoulder.jp</a> <br/>
<a href="http://pentan.info/php/session_gc.html">ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé–“ã¨ã‹è¨­å®šã¨ã‹æŒ™å‹•ã¨ã‹ã‚’èª¿ã¹ã¾ã—ãŸ &ndash; [PHP + PHP] ãºã‚“ãŸã‚“ info</a><br/>
<a href="http://pentan.info/php/session_fixation.html">ã‚»ãƒƒã‚·ãƒ§ãƒ³å›ºå®šæ”»æ’ƒ(session fixation) &ndash; [PHP + PHP] ãºã‚“ãŸã‚“ info</a><br/>
<a href="http://blog.ohgaki.net/session_regenerate_id_wo">ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«session_regenerate_id()ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã§ååˆ†ã‹? | yohgaki&#039;s blog</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[salesforce]ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ™‚ã®ã‚¨ãƒ©ãƒ¼]]></title>
    <link href="http://kayakuguri.github.io/blog/2015/05/01/salesforce-outbound-xml/"/>
    <updated>2015-05-01T14:26:22+09:00</updated>
    <id>http://kayakuguri.github.io/blog/2015/05/01/salesforce-outbound-xml</id>
    <content type="html"><![CDATA[<p>å…ˆæ—¥ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’PHPã§å—ã‘ã¨ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸã‘ã‚Œã©ã€è©¦ã—ã¦ã„ã‚‹ã¨ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ãŒSalesforceå´ã‹ã‚‰ä½•åº¦ã‚‚è©¦è¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚</p>

<!-- more -->


<p>salesforceå´ã®ãƒ­ã‚°ã‚’è¦‹ã¦ã„ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹ã€‚<br/>
<code>è¨­å®š &gt; ç›£è¦– &gt; ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</code></p>

<p><img src="/images/2015/05/outbound_error.jpg" alt="ã‚¨ãƒ©ãƒ¼" /></p>

<blockquote><p>org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Content is not allowed in prolog.</p></blockquote>

<p>ã©ã†ã‚„ã‚‰ã€PHPå´ã®å¿œç­”ãŒã€SOAPã®å½¢å¼ã«å‰‡ã£ã¦ãªã„ã¨salesforceå´ã§XMLã®è§£æãŒã§ããšã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã—ã¾ã†ã£ã½ã„ã€‚<br/>
ãªã®ã§ã€ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚Œã‚‹ã¾ã§æ•°å›è©¦è¡ŒãŒç¶šãã€ã£ã½ã„ã€‚</p>

<p>å¿œç­”ã¯XMLã®å½¢å¼ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã§ã€headerã§XMLã¨ã—ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚</p>

<pre><code>header("Content-Type: application/xml; charset=UTF-8");
</code></pre>

<p>ã¾ãŸã€è¿”å´ã™ã‚‹XMLã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã§ãªã„ã¨ã„ã‘ãªã„ã‚ˆã†ã€‚</p>

<p>```
&lt;soapenv:Envelope xmlns:soapenv=&ldquo;<a href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a>&rdquo;></p>

<pre><code>&lt;soapenv:Body&gt;
    &lt;notificationsResponse xmlns="http://soap.sforce.com/2005/09/outbound"&gt;
    &lt;Ack&gt;true&lt;/Ack&gt;
&lt;/notificationsResponse&gt;
&lt;/soapenv:Body&gt;
</code></pre>

<p>&lt;/soapenv:Envelope>
```</p>

<p>ã¨ã„ã†ã‚ã‘ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«PHPã‚’æ›¸ã„ã¦ã‚„ã‚Œã°ã‚¨ãƒ©ãƒ¼ã¯å‡ºãªã„ã€‚</p>

<p>```
&lt;?php
header(&ldquo;Content-Type: application/xml; charset=UTF-8&rdquo;);</p>

<p>//&mdash;ä½•ã‚‰ã‹ã®å‡¦ç†&mdash;</p>

<p>$response = &lsquo;&lt;soapenv:Envelope xmlns:soapenv=&ldquo;<a href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a>&rdquo;>&lt;soapenv:Body><notificationsResponse xmlns="http://soap.sforce.com/2005/09/outbound"><Ack>true</Ack></notificationsResponse>&lt;/soapenv:Body>&lt;/soapenv:Envelope>&rsquo;;
echo $response;
```</p>

<h2>å‚è€ƒ</h2>

<p><a href="http://www.tgerm.com/2014/08/testing-soap-outbound-messages-without-failures-saxexception.html">{!blog.concret.io}: Testing SOAP Outbound Messages without failures</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Salesforce]æ‰¿èªç”³è«‹ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’PHPã§å—ã‘å–ã‚‹]]></title>
    <link href="http://kayakuguri.github.io/blog/2015/04/28/approval-process-outbound-massage/"/>
    <updated>2015-04-28T20:20:01+09:00</updated>
    <id>http://kayakuguri.github.io/blog/2015/04/28/approval-process-outbound-massage</id>
    <content type="html"><![CDATA[<p>salesforceã‹ã‚‰ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã‚’PHPã§å—ã‘å–ã£ã¦ã¿ãŸã€‚</p>

<!-- more -->


<h2>ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨­å®š</h2>

<p>å‰å›ä½œæˆã—ãŸã‚‚ã®ã®ç”³è«‹æ™‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³éƒ¨åˆ†ã«<code>ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</code>ã‚’è¿½åŠ ã€‚<br/>
<img src="/images/2015/04/outbound01.jpg" alt="" /></p>

<p>ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ãŸã€‚<br/>
<img src="/images/2015/04/outbound02.jpg" alt="" /></p>

<p>è¨­å®šå®Œäº†<br/>
<img src="/images/2015/04/outbound03.jpg" alt="" /></p>

<h2>PHPã§å—ã‘å–ã‚‹</h2>

<p>ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯<code>SOAP</code>ã§é€šä¿¡ãŒè¡Œã‚ã‚Œã‚‹ã€‚<br/>
ãªã®ã§ã€XMLã€‚<br/>
ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ãŸã€‚</p>

<pre><code>at=info method=POST path="/liam_dnes.php?id=1" host=shrouded-island-xxxx.herokuapp.com request_id=01b99464-c9dc-4e15-aa19-xxxxxxx fwd="xxx.xxx.78.8" dyno=web.1 connect=1ms service=4ms status=200 bytes=189
</code></pre>

<p>ã©ã†ã‚„ã‚‰POSTã§ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã€‚<br/>
<code>$_POST</code>ã®ã¾ã¾ã§ã¯å–å¾—ã§ããªã‹ã£ãŸã€‚<br/>
ã©ã†ã‚„ã‚‰ç”Ÿã®POSTãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚‰ã—ã„ã€‚</p>

<p>ä»¥ä¸‹ã§å–å¾—ã—ãŸã€‚</p>

<pre><code>$data = file_get_contents( 'php://input' );
</code></pre>

<p>å–å¾—ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªXMLãŒå–å¾—ã§ããŸã€‚</p>

<p>```
&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;UTF-8&rdquo;?>
&lt;soapenv:Envelope xmlns:soapenv=&ldquo;<a href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a>&rdquo; xmlns:xsd=&ldquo;<a href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a>&rdquo; xmlns:xsi=&ldquo;<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>&rdquo;></p>

<pre><code>&lt;soapenv:Body&gt;
    &lt;notifications xmlns="http://soap.sforce.com/2005/09/outbound"&gt;
        &lt;OrganizationId&gt;00D10000000Zyxxxxx&lt;/OrganizationId&gt;
        &lt;SessionId xsi:nil="true"/&gt;
        &lt;PartnerUrl&gt;https://ap.salesforce.com/services/Soap/u/33.0/00D100000xxxxx&lt;/PartnerUrl&gt;
        &lt;ActionId&gt;04k100000008STGAA2&lt;/ActionId&gt;
        &lt;EnterpriseUrl&gt;https://ap.salesforce.com/services/Soap/c/33.0/00D100000xxxxx&lt;/EnterpriseUrl&gt;
        &lt;Notification&gt;
            &lt;Id&gt;04l1000000xxxxxx&lt;/Id&gt;
            &lt;sObject xsi:type="sf:Opportunity" xmlns:sf="urn:sobject.enterprise.soap.sforce.com"&gt;
                &lt;sf:Id&gt;0061000000cxxxxx&lt;/sf:Id&gt;
                &lt;sf:Name&gt;ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã®ãƒ†ã‚¹ãƒˆå•†è«‡&lt;/sf:Name&gt;
                &lt;sf:StageName&gt;Prospecting&lt;/sf:StageName&gt;
                &lt;sf:IsClosed&gt;false&lt;/sf:IsClosed&gt;
            &lt;/sObject&gt;
        &lt;/Notification&gt;
    &lt;/notifications&gt;
&lt;/soapenv:Body&gt;
</code></pre>

<p>&lt;/soapenv:Envelope>
```</p>

<p>ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã®è¨­å®šã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã€‚</p>

<p>ã“ã“ã‹ã‚‰XMLã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã€åå‰ãªã©è¨­å®šã—ãŸå€¤ã‚’å–å¾—ã™ã‚‹ã«ã¯ä»¥ä¸‹ã€‚</p>

<p>```
&lt;?php</p>

<p>$data = file_get_contents(&lsquo;php://input&rsquo;);
$xml = simplexml_load_string($data);</p>

<p>//ID
$notification = $xml->children(&lsquo;<a href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a>&rsquo;)&ndash;>Body->children(&lsquo;<a href="http://soap.sforce.com/2005/09/outbound">http://soap.sforce.com/2005/09/outbound</a>&rsquo;)&ndash;>notifications->Notification;
echo $notification->Id;</p>

<p>//ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
$params = $notification->sObject->children(&lsquo;urn:sobject.enterprise.soap.sforce.com&rsquo;);
echo $params->Id;
echo $params->Name;
echo $params->IsClosed;
```</p>

<h2>å‚è€ƒ</h2>

<p><a href="http://php.net/manual/ja/wrappers.php.php#wrappers.php.input">php://input</a><br/>
<a href="http://ivystar.jp/programming/php/what-is-phpinput/">ã€Œphp://inputã€ã¨ã¯ä½•ï¼Ÿï¼POSTã®ç”Ÿãƒ‡ãƒ¼ã‚¿ï¼Ÿ | ã‚¢ã‚¤ãƒ“ãƒ¼ã‚¹ã‚¿ãƒ¼</a><br/>
<a href="https://amigotechnotes.wordpress.com/2013/11/16/parse-xml-with-namespace-by-simplexml-in-php/">Parse XML with namespace by SimpleXML in PHP | Amigo&#039;s Technical Notes</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Laravel5ã‚’postgresqlã§Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤]]></title>
    <link href="http://kayakuguri.github.io/blog/2015/04/21/laravel5-on-heroku/"/>
    <updated>2015-04-21T10:59:17+09:00</updated>
    <id>http://kayakuguri.github.io/blog/2015/04/21/laravel5-on-heroku</id>
    <content type="html"><![CDATA[<p>Laravel5ã‚’herokuã«å…¥ã‚Œã¦ã¿ã¾ã—ãŸã€‚<br/>
ãƒ–ãƒ©ã‚¦ã‚¶ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã®æ“ä½œã¯ä¸€åˆ‡ãªã—ã§ã€é»’ã„ç”»é¢ã®ã¿ã§ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<!-- more -->


<h2>mcrypt</h2>

<p>ãƒ­ãƒ¼ã‚«ãƒ«ã«ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ãªã„ã¨æ€’ã‚‰ã‚ŒãŸã®ã§å°å…¥ã€‚<br/>
ã¾ãŸã€PHPã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„å ´åˆã¯ã€<a href="http://kayamemo.mrlittlebig.com/blog/2015/04/15/mac-update-php/">ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒå¿…è¦</a>ã€‚</p>

<p>```
$ php -v                                                                                                           [ruby-2.1.2]
PHP 5.6.7 (cli) (built: Mar 22 2015 19:03:55)
Copyright &copy; 1997-2015 The PHP Group
Zend Engine v2.6.0, Copyright &copy; 1998-2015 Zend Technologies</p>

<p>$ brew search mcrypt                                                                                               [ruby-2.1.2]
libtomcrypt    mcrypt         php53-mcrypt   php54-mcrypt   php55-mcrypt   php56-mcrypt</p>

<p>$ brew install php56-mcrypt
&hellip;ç•¥&hellip;
==> Summary
  /usr/local/Cellar/php56-mcrypt/5.6.7: 3 files, 56K, built in 116 seconds
```</p>

<h2>laravelã®å°å…¥</h2>

<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>

<p><code>
$ composer create-project laravel/laravel --prefer-dist laravel-sample-on-heroku
...ç•¥...
$ cd laravel-sample-on-heroku
</code></p>

<p>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã®è¨­å®š</p>

<p><code>
$ touch Procfile
$ echo 'web: vendor/bin/heroku-php-apache2 public' &gt;&gt; Procfile
</code></p>

<p>Gitã‚’ä½œæˆ</p>

<p><code>
$ git init
$ git add .
$ git commit -m 'init laravel'
</code></p>

<p>herokuã‚¢ãƒ—ãƒªã®ä½œæˆ</p>

<p><code>
$ heroku create laravel-sample-on-heroku
Creating laravel-sample-on-heroku... done, stack is cedar-14
https://laravel-sample-on-heroku.herokuapp.com/ | https://git.heroku.com/laravel-sample-on-heroku.git
Git remote heroku added
</code></p>

<p>ã“ã®ã¾ã¾ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ã€<code>package.json</code>ãŒãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ãŸã‚ã€<code>nodejs</code>ã®ã‚¢ãƒ—ãƒªã«ãªã£ã¦ã—ã¾ã†ã€‚<br/>
ãªã®ã§ã€phpã®ãƒ“ãƒ«ãƒ‰ãƒ‘ãƒƒã‚¯ã‚’è¿½åŠ ã€‚<br/>
<a href="https://github.com/heroku/heroku-buildpack-php">https://github.com/heroku/heroku-buildpack-php</a></p>

<p><code>
$ heroku config:set BUILDPACK_URL=https://github.com/heroku/heroku-buildpack-php
Setting config vars and restarting laravel-sample-on-heroku... done, v4
BUILDPACK_URL: https://github.com/heroku/heroku-buildpack-php
</code></p>

<blockquote><p>ã‚¢ãƒ—ãƒªã®ä½œæˆã¨åŒæ™‚ã«ã™ã‚‹ã«ã¯ã€<code>create</code>ã®å¾Œã«ã€<code>--buildpack URL</code>ã‚’è¿½åŠ ã—ã¦ã‚„ã‚‹ã¨ä¸€å›ã§è¨­å®šã§ãã‚‹ã€‚<br/>
$ heroku create laravel-sample-on-heroku &mdash;buildpack URL xxx</p></blockquote>

<p>ã™ã§ã«ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€pushã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã€‚</p>

<pre><code>$ git push heroku master
</code></pre>

<p>ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¨ã™ã§ã«å‹•ä½œã™ã‚‹çŠ¶æ…‹ã€‚</p>

<pre><code>$ heroku open
</code></pre>

<p>å®Œäº†ï¼</p>

<h2>DBã®è¨­å®š</h2>

<p>ã‚¢ãƒ‰ã‚ªãƒ³ã‚’è¿½åŠ (ç„¡æ–™)</p>

<pre><code>$ heroku addons:add heroku-postgresql:dev
</code></pre>

<p>DBã®æƒ…å ±ã‚’å–å¾—</p>

<pre><code>$ heroku config | grep HEROKU_POSTGRESQL
HEROKU_POSTGRESQL_CRIMSON_URL: postgres://UserName:Password@Host.compute-1.amazonaws.com:Port/DatabaseName  
</code></pre>

<p>ç”Ÿæˆã—ãŸDBã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã«è¨­å®š</p>

<pre><code>$ heroku pg:promote HEROKU_POSTGRESQL_CRIMSON_URL
Promoting HEROKU_POSTGRESQL_CRIMSON_URL (DATABASE_URL) to DATABASE_URL... done
</code></pre>

<p>ã“ã“ã‹ã‚‰ã¯ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†</p>

<pre><code>$ vi config/database.php
---
//29è¡Œç›®
'default' =&gt; 'mysql',
â†“
'default' =&gt; 'pgsql',
---
//å†’é ­ã«è¿½åŠ 
$url = parse_url(getenv("DATABASE_URL"));

$host = $url["host"];
$username = $url["user"];
$password = $url["pass"];
$database = substr($url["path"], 1);
---
//67è¡Œç›®ã‹ã‚‰
'pgsql' =&gt; [
    'driver'   =&gt; 'pgsql',
    'host'     =&gt; $host,
    'database' =&gt; $database,
    'username' =&gt; $username,
    'password' =&gt; $password,
    'charset'  =&gt; 'utf8',
    'prefix'   =&gt; '',
    'schema'   =&gt; 'public',
],
</code></pre>

<p>pushã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤</p>

<pre><code>$ git add .
$ git commit -m 'setup Heroku PostgreSQL'
$ git push heroku master
</code></pre>

<p>æœ€å¾Œã«<a href="http://laravel3.kore1server.com/docs/database/migrations">ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</a>ã‚’å®Ÿè¡Œ</p>

<p><code>``
$ heroku run php artisan migrate
Running</code>php artisan migrate` attached to terminal&hellip; up, run.4728</p>

<hr />

<ul>
<li>  Application In Production!     *</li>
</ul>


<hr />

<p>Do you really wish to run this command? [y/N]y
Migration table created successfully.
Migrated: 2014_10_12_000000_create_users_table
Migrated: 2014_10_12_100000_create_password_resets_table
<code>``
</code>/auth/register<code>ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ç”»é¢ã€‚  
</code>/auth/login<code>ã§ãƒ­ã‚°ã‚¤ãƒ³ã€‚  
</code>/password/email`ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã«ãªã‚‹ã€‚<br/>
(ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã¯è¨­å®šã—ã¦ã„ãªã„ã®ã§å‡ºæ¥ãªã„)</p>

<p>ä¸€é€šã‚Šã®è¨­å®šã¯ã“ã‚Œã§å®Œäº†ï¼<br/>
ã‚ã¨ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿æŒã«<a href="https://addons.heroku.com/memcachier">MemCachier</a>ã‹<a href="https://addons.heroku.com/?q=redi">Redis To Go</a>ã®è¨­å®šã‚„ã€<br/>
ãƒ¡ãƒ¼ãƒ«é€ä¿¡ç”¨ã«<a href="https://addons.heroku.com/sendgrid">SendGrid</a>ãªã©ãŒå¿…è¦ã«ãªã‚‹ã¨æ€ã†ã€‚</p>

<h2>ã‚µãƒ³ãƒ—ãƒ«</h2>

<p>ä½œæˆã—ãŸã‚¢ãƒ—ãƒªã¯ä»¥ä¸‹ã€‚</p>

<p><a href="http://laravel-sample-on-heroku.herokuapp.com">http://laravel-sample-on-heroku.herokuapp.com</a></p>

<h2>å‚è€ƒ</h2>

<p><a href="http://qiita.com/MasatoYoshioka@github/items/1b4de4249dc40ff1d902">macosxã®phpã«mcryptã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« &ndash; Qiita</a><br/>
<a href="http://www.slideshare.net/esolves/deploy-laravel-on-heroku">Deploy Laravel on Heroku</a><br/>
<a href="https://mattstauffer.co/blog/laravel-on-heroku-using-a-postgresql-database">Laravel on Heroku &ndash; Using a PostgreSQL database &ndash; MattStauffer.co</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[mac]macã®PHPã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹]]></title>
    <link href="http://kayakuguri.github.io/blog/2015/04/15/mac-update-php/"/>
    <updated>2015-04-15T20:15:38+09:00</updated>
    <id>http://kayakuguri.github.io/blog/2015/04/15/mac-update-php</id>
    <content type="html"><![CDATA[<p>ã¨ã‚ã‚‹SDKã‚’composerçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€PHPã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ã€ã¨æ€’ã‚‰ã‚Œã¦ã—ã¾ã£ãŸã€‚<br/>
ãªã®ã§ã€macã§5.6ã«ã—ãŸãƒ¡ãƒ¢ã€‚</p>

<!-- more -->


<p>ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå‰ã€‚</p>

<p><code>
$ php -v
PHP 5.4.38 (cli) (built: Mar 19 2015 14:49:15)
Copyright (c) 1997-2014 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2014 Zend Technologies
</code></p>

<hr />

<p>åŸºæœ¬çš„ã«ä»¥ä¸‹ã®ãƒãƒã€‚<br/>
<code>homebrew</code>ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã€‚</p>

<p><a href="http://takemaru123.hatenablog.jp/entry/2014/11/27/224037">macã«homebrewã§PHP5.6ç’°å¢ƒã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã‚‹ &ndash; ãŸã‘ã¾ã‚‹ã®æ—¥è¨˜</a></p>

<p>ã¾ãšã€xcode-selectã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã€‚<br/>
(Xcodeè‡ªä½“ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦)<br/>
(ç†ç”±ã¯ã‚ã‹ã¦ãªã„)</p>

<pre><code>$ xcode-select --install
</code></pre>

<p>ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚ŒãŸã€‚</p>

<blockquote><p>xcode-select: note: install requested for command line developer tools</p></blockquote>

<p><img src="/images/2015/04/mac_php_update_1.png" alt="ãƒ€ã‚¤ã‚¢ãƒ­ã‚°" /></p>

<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ã‚’æŠ¼ã™ã¨è¦ç´„åŒæ„ç”»é¢ã«é€²ã¿ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå§‹ã¾ã‚‹ã€‚</p>

<p><img src="/images/2015/04/mac_php_update_2.png" alt="è¦ç´„åŒæ„" /><br/>
<img src="/images/2015/04/mac_php_update_3.png" alt="ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­" /></p>

<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã«ä»¥ä¸‹ã§homebrewã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã€‚<br/>
(ã“ã“ã‚‚ã‚ˆãã‚ã‹ã£ã¦ãªã„)</p>

<pre><code>$ brew tap homebrew/php
$ brew tap homebrew/dupes
</code></pre>

<p>ã§ã€ã„ã‚ˆã„ã‚ˆPHP5.6ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚</p>

<pre><code>$ brew install php56 --with-apxs2=/usr/sbin/apxs
~~~~~
==&gt; Summary
ğŸº  /usr/local/Cellar/php56/5.6.7: 500 files, 51M
</code></pre>

<p>ã§ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å†èµ·å‹•ã™ã‚‹ã¨ã€ç„¡äº‹ã€ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸã€‚</p>

<p><code>
$ php -v
PHP 5.6.7 (cli) (built: Mar 22 2015 19:03:55)
Copyright (c) 1997-2015 The PHP Group
Zend Engine v2.6.0, Copyright (c) 1998-2015 Zend Technologies
</code></p>
]]></content>
  </entry>
  
</feed>
